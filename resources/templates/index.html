<html>
<head>
<title>key.run</title>
<style>

#content {
  width: 550px;
  margin: 0 auto;
}

.tx-hash-link {
  font-size: 10px;
}

#encode-input {
}

#transactions {
}

</style>
</head>
<body>
<script type="text/javascript">
var keyrun = {};

keyrun.getToEncode = function() {
  return document.getElementById("encode-value").value;
}

keyrun.createPaymentURL = function(string) {
  if (string) {
    return "bitcoin:?r=http%3A%2F%2F" + encodeURIComponent(location.host) + "%2Fkr%2Fmessage%2Fpayreq%3Fmessage%3D" + encodeURIComponent(string.replace(/ /g, "+"))
  }
}

keyrun.payIt = function() {
  var encodeValue = keyrun.getToEncode();
  if (encodeValue) {
    var paymentURL = keyrun.createPaymentURL(encodeValue);
    console.log("PaymentURL: " + paymentURL);
    window.open(paymentURL);
    document.getElementById("encode-value").value = "";
  }
  return false;
}
</script>
<div id="content">
  <div id="encode-input">
    <form onsubmit="return keyrun.payIt()">
      <input type="text" id="encode-value">
      <input type="submit" value="Run it!">
    </form>
  </div>
  <table id="transactions">
    {{#transactions}}
    <tr>
      <td>{{data}}</td>
      <td><a class="tx-hash-link" href="https://blockchain.info/tx/{{tx-hash}}">{{tx-hash}}</a></td>
      <td>{{friendly-value}}</td>
    </tr>
    {{/transactions}}
  </div>
</div>
</body>
<html>
